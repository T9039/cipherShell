<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>CipherShell</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap");

      /* --- CATPPUCCIN MOCHA PALETTE --- */
      :root {
        --base: #1e1e2e;
        --text: #cdd6f4;
        --mauve: #cba6f7;
        --blue: #89b4fa;
        --red: #f38ba8;
        --green: #a6e3a1;
        --overlay: #6c7086;
        --crust: #11111b;
      }

      body {
        font-family: "JetBrains Mono", monospace;
        background-color: #000;
        background-image: linear-gradient(
          to bottom right,
          #0f0c29,
          #302b63,
          #24243e
        );
        color: var(--text);
        /* Prevent scrolling the background layer on mobile */
        overflow: hidden;
        height: 100vh;
        width: 100vw;
      }

      /* Glassmorphism Terminal */
      .terminal-window {
        /* CHANGED: 0.85 -> 0.70 to let the wallpaper shine through */
        background-color: rgba(30, 30, 46, 0.7);
        backdrop-filter: blur(12px);
        border: 1px solid var(--overlay);
        box-shadow: 0 0 40px rgba(0, 0, 0, 0.5);
      }

      /* Blinking Block Cursor */
      .cursor-block {
        display: inline-block;
        width: 10px;
        height: 1.2em;
        background-color: var(--text);
        animation: blink 1s step-end infinite;
        vertical-align: text-bottom;
      }
      @keyframes blink {
        50% {
          opacity: 0;
        }
      }

      /* CLI Input Styles */
      .cli-input {
        background: transparent;
        border: none;
        color: var(--green);
        outline: none;
        width: 100%;
        font-family: inherit;
      }
      .cli-input::placeholder {
        color: var(--overlay);
        opacity: 0.5;
      }

      /* Hide Scrollbar */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }

      /* Tmux Active/Inactive Tab Styles */
      .tab-active {
        background-color: var(--mauve);
        color: var(--base);
        font-weight: bold;
      }
      .tab-inactive {
        color: var(--overlay);
      }
    </style>
  </head>
  <body class="flex items-center justify-center md:p-4 p-0">
    <div
      class="terminal-window w-full h-[100dvh] md:h-[85vh] md:max-w-5xl flex flex-col md:rounded-lg rounded-none overflow-hidden relative transition-all duration-300"
    >
      <div
        class="bg-[#11111b] p-3 md:p-2 text-center text-xs text-[#6c7086] border-b border-[#6c7086]/30 select-none shrink-0"
      >
        <span class="md:hidden">mobile@ciphershell: ~ (zsh)</span>
        <span class="hidden md:inline"
          >user@archlinux: ~/ciphershell (zsh)</span
        >
      </div>

      <div class="flex-1 p-4 md:p-6 overflow-y-auto no-scrollbar flex flex-col">
        <pre
          class="text-[#cba6f7] font-bold text-[8px] md:text-sm mb-4 leading-tight select-none whitespace-pre-wrap"
        >
  ____ _       _                 ____  _          _ _ 
 / ___(_)_ __ | |__   ___ _ __  / ___|| |__   ___| | |
| |   | | '_ \| '_ \ / _ \ '__| \___ \| '_ \ / _ \ | |
| |___| | |_) | | | |  __/ |     ___) | | | |  __/ | |
 \____|_| .__/|_| |_|\___|_|    |____/|_| |_|\___|_|_|
        |_|                                           
            </pre
        >

        <div class="mb-6 text-xs md:text-sm text-[#bac2de]">
          <p>> CipherShell v1.1.0 (Mobile Optimized)</p>
          <p class="hidden md:block">
            > Shortcuts:
            <span class="text-[#f38ba8]">Ctrl+Shift+1..3</span> (Tabs) |
            <span class="text-[#f38ba8]">Ctrl+G</span> (Gen Keys) |
            <span class="text-[#f38ba8]">Ctrl+E/D</span> (Action)
          </p>
          <p class="md:hidden">
            > Touch Controls: <span class="text-[#a6e3a1]">Active</span>
          </p>
          <div class="border-b border-[#6c7086]/30 my-4"></div>
        </div>

        <div
          id="section-generator"
          class="flex-1 flex flex-col justify-start md:justify-center items-start space-y-6"
        >
          <div class="w-full">
            <p class="text-[#89b4fa] mb-2">// PASSWORD_GENERATOR</p>
            <p class="text-xs md:text-sm text-[#6c7086] mb-4">
              Select entropy method.
            </p>

            <div class="flex flex-col md:flex-row gap-4 mb-6 text-sm">
              <button
                onclick="generatePass('random')"
                class="border border-[#a6e3a1]/30 p-3 md:border-none md:p-0 text-center hover:text-white text-[#a6e3a1] transition-colors rounded md:rounded-none"
              >
                [ Random_Mode ]
              </button>
              <button
                onclick="generatePass('memorable')"
                class="border border-[#a6e3a1]/30 p-3 md:border-none md:p-0 text-center hover:text-white text-[#a6e3a1] transition-colors rounded md:rounded-none"
              >
                [ Memorable_Mode ]
              </button>
            </div>

            <div class="bg-[#11111b]/50 p-4 border-l-2 border-[#cba6f7] w-full">
              <span class="text-[#6c7086] text-xs">$ output: </span>
              <div
                id="pass-output"
                class="text-lg md:text-xl text-[#cdd6f4] break-all mt-2 min-h-[3rem]"
              >
                _waiting_for_input
              </div>
            </div>
            <button
              onclick="copyToClipboard('pass-output')"
              class="mt-4 w-full md:w-auto border border-[#6c7086] p-2 md:border-none md:p-0 text-xs text-[#6c7086] hover:text-[#cdd6f4]"
            >
              [ Copy to Clipboard ]
            </button>
          </div>
        </div>

        <div id="section-vault" class="hidden flex-1 flex flex-col space-y-6">
          <p class="text-[#f38ba8] mb-2">// SECURE_VAULT (AES-128)</p>

          <div class="space-y-6 w-full max-w-3xl">
            <div class="flex flex-col md:flex-row md:items-start gap-2">
              <span
                class="text-[#a6e3a1] whitespace-nowrap text-xs md:text-base"
                >user@vault:~/msg $</span
              >
              <textarea
                id="vault-input"
                rows="3"
                class="cli-input text-base md:text-sm resize-none bg-[#11111b]/20 p-2 md:p-0 rounded md:rounded-none"
                placeholder="Enter plaintext..."
              ></textarea>
            </div>

            <div class="flex flex-col md:flex-row md:items-center gap-2">
              <span
                class="text-[#a6e3a1] whitespace-nowrap text-xs md:text-base"
                >user@vault:~/key $</span
              >
              <input
                type="password"
                id="vault-pass"
                class="cli-input text-base md:text-sm bg-[#11111b]/20 p-2 md:p-0 rounded md:rounded-none"
                placeholder="Enter passphrase..."
              />
            </div>

            <div class="pt-4 flex flex-col md:flex-row gap-4 text-sm">
              <button
                onclick="processVault('encrypt')"
                class="border border-[#89b4fa] p-3 md:border-none md:p-0 text-center text-[#89b4fa] hover:bg-[#89b4fa] hover:text-[#1e1e2e] rounded md:rounded-none transition-colors font-bold"
              >
                ENCRYPT >>
              </button>
              <button
                onclick="processVault('decrypt')"
                class="border border-[#f38ba8] p-3 md:border-none md:p-0 text-center text-[#f38ba8] hover:bg-[#f38ba8] hover:text-[#1e1e2e] rounded md:rounded-none transition-colors font-bold"
              >
                << DECRYPT
              </button>
            </div>

            <div class="mt-6 border-t border-[#6c7086]/30 pt-4 pb-12">
              <div class="text-[#6c7086] text-sm mb-1">STDOUT >></div>
              <div
                id="vault-result"
                class="text-[#cdd6f4] break-all font-mono text-sm"
              >
                // Process output will appear here...
              </div>
              <button
                onclick="copyToClipboard('vault-result')"
                class="mt-4 w-full md:w-auto border border-[#6c7086] p-2 md:border-none md:p-0 text-xs text-[#6c7086] hover:text-[#cdd6f4]"
              >
                [ Copy Output ]
              </button>
            </div>
          </div>
        </div>

        <div
          id="section-identity"
          class="hidden flex-1 flex flex-col space-y-8 pb-20"
        >
          <div>
            <p class="text-[#f38ba8] mb-2 text-xs uppercase font-bold">
              // 1. MY_IDENTITY (KEYPAIR)
            </p>
            <button
              onclick="generateIdentity()"
              class="w-full md:w-auto mb-4 text-xs border border-[#a6e3a1] text-[#a6e3a1] px-3 py-3 md:py-1 hover:bg-[#a6e3a1] hover:text-[#1e1e2e] transition-colors rounded md:rounded-none"
            >
              [ GENERATE_NEW_KEYPAIR_2048 ]
            </button>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
              <div class="relative group">
                <label class="text-[10px] text-[#a6e3a1] block mb-1"
                  >PUBLIC_KEY</label
                >
                <textarea
                  id="rsa-public"
                  readonly
                  class="w-full h-24 bg-[#11111b]/50 border border-[#a6e3a1]/50 p-2 text-[10px] leading-tight text-[#a6e3a1] resize-none focus:border-[#a6e3a1] outline-none font-mono rounded"
                ></textarea>
                <button
                  onclick="copyToClipboard('rsa-public')"
                  class="absolute top-2 right-2 text-[10px] bg-[#1e1e2e] border border-[#a6e3a1] px-2 py-1 hover:bg-[#a6e3a1] hover:text-black rounded"
                >
                  CPY
                </button>
              </div>

              <div class="relative group">
                <label class="text-[10px] text-[#f38ba8] block mb-1"
                  >PRIVATE_KEY</label
                >
                <textarea
                  id="rsa-private"
                  readonly
                  class="w-full h-24 bg-[#11111b]/50 border border-[#f38ba8]/50 p-2 text-[10px] leading-tight text-[#f38ba8] resize-none focus:border-[#f38ba8] outline-none font-mono rounded"
                ></textarea>
                <button
                  onclick="copyToClipboard('rsa-private')"
                  class="absolute top-2 right-2 text-[10px] bg-[#1e1e2e] border border-[#f38ba8] px-2 py-1 hover:bg-[#f38ba8] hover:text-black rounded"
                >
                  CPY
                </button>
              </div>
            </div>
          </div>

          <div class="border-t border-[#6c7086]/30 pt-6">
            <p class="text-[#89b4fa] mb-4 text-xs uppercase font-bold">
              // 2. ASYMMETRIC_MESSAGING
            </p>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
              <div
                class="space-y-2 bg-[#11111b]/20 p-2 md:bg-transparent md:p-0 rounded"
              >
                <p class="text-xs text-[#6c7086]">> Encrypt for recipient</p>
                <input
                  id="rsa-msg-in"
                  class="w-full bg-transparent border-b border-[#6c7086] py-2 md:py-1 text-base md:text-sm focus:border-[#89b4fa] outline-none"
                  placeholder="Enter Message..."
                />

                <textarea
                  id="rsa-remote-key"
                  class="w-full h-20 bg-[#11111b]/30 border border-[#6c7086]/50 p-2 text-[10px] resize-none focus:border-[#89b4fa] outline-none text-[#6c7086] rounded"
                  placeholder="Paste Recipient's Public Key Here..."
                ></textarea>
                <button
                  onclick="processRSA('encrypt')"
                  class="w-full border border-[#89b4fa] text-[#89b4fa] hover:bg-[#89b4fa] hover:text-[#1e1e2e] py-3 md:py-1 text-sm transition-colors font-bold rounded md:rounded-none"
                >
                  ENCRYPT >>
                </button>
              </div>

              <div
                class="space-y-2 bg-[#11111b]/20 p-2 md:bg-transparent md:p-0 rounded"
              >
                <p class="text-xs text-[#6c7086]">
                  > Decrypt with MY Private Key
                </p>

                <div class="hidden md:block h-[29px] w-full"></div>

                <textarea
                  id="rsa-cipher-in"
                  class="w-full h-20 bg-[#11111b]/30 border border-[#6c7086]/50 p-2 text-[10px] resize-none focus:border-[#f38ba8] outline-none text-[#6c7086] rounded"
                  placeholder="Paste Ciphertext Here..."
                ></textarea>

                <button
                  onclick="processRSA('decrypt')"
                  class="w-full border border-[#f38ba8] text-[#f38ba8] hover:bg-[#f38ba8] hover:text-[#1e1e2e] py-3 md:py-1 text-sm transition-colors font-bold rounded md:rounded-none"
                >
                  << DECRYPT
                </button>
              </div>
            </div>

            <div class="mt-6 pb-6">
              <span class="text-[#6c7086] text-xs">$ rsa_output: </span>
              <div
                id="rsa-result"
                class="text-sm text-[#cdd6f4] break-all font-mono mt-2 p-2 bg-[#11111b]/30 rounded"
              >
                _waiting_
              </div>
              <button
                onclick="copyToClipboard('rsa-result')"
                class="mt-2 w-full md:w-auto border border-[#6c7086] p-2 md:border-none md:p-0 text-xs text-[#6c7086] hover:text-[#cdd6f4]"
              >
                [ Copy Output ]
              </button>
            </div>
          </div>
        </div>
      </div>
      <div
        class="bg-[#11111b] text-sm flex justify-between items-center select-none z-50 border-t border-[#6c7086]/30 shrink-0 h-14 md:h-auto"
      >
        <div
          class="bg-[#11111b] text-sm flex justify-between items-center select-none z-50 border-t border-[#6c7086]/30 shrink-0 pb-10 pt-3 md:pb-0 md:pt-0 md:py-1 md:h-auto"
        >
          <div class="flex w-full md:w-auto">
            <div
              id="tab-gen"
              onclick="switchTab('generator')"
              class="cursor-pointer px-2 md:px-4 tab-active flex-1 md:flex-none flex justify-center gap-2 hover:bg-[#313244] transition-colors border-r border-[#6c7086]/20 md:border-none py-2 md:py-1"
            >
              <span class="opacity-50 text-xs md:text-sm">1</span>
              <span class="text-xs md:text-sm font-bold">GEN</span>
            </div>

            <div
              id="tab-vault"
              onclick="switchTab('vault')"
              class="cursor-pointer px-2 md:px-4 tab-inactive flex-1 md:flex-none flex justify-center gap-2 hover:bg-[#313244] transition-colors border-r border-[#6c7086]/20 md:border-none py-2 md:py-1"
            >
              <span class="opacity-50 text-xs md:text-sm">2</span>
              <span class="text-xs md:text-sm font-bold">VAULT</span>
            </div>

            <div
              id="tab-identity"
              onclick="switchTab('identity')"
              class="cursor-pointer px-2 md:px-4 tab-inactive flex-1 md:flex-none flex justify-center gap-2 hover:bg-[#313244] transition-colors py-2 md:py-1"
            >
              <span class="opacity-50 text-xs md:text-sm">3</span>
              <span class="text-xs md:text-sm font-bold">ID</span>
            </div>
          </div>

          <div class="px-4 text-[#a6e3a1] hidden md:block">
            <span class="text-[#f38ba8]">♥</span> 100%
            <span id="clock-display" class="ml-4 text-[#89b4fa] font-bold"
              >Initializing...</span
            >
          </div>
        </div>

        <!-- <div class="px-4 text-[#a6e3a1] hidden md:block"> -->
        <!--   <span class="text-[#f38ba8]">♥</span> 100% -->
        <!--   <span id="clock-display" class="ml-4 text-[#89b4fa] font-bold" -->
        <!--     >Initializing...</span -->
        <!--   > -->
        <!-- </div> -->
      </div>
    </div>
    <script src="{{ url_for('static', filename='script2.js') }}"></script>
  </body>
</html>
